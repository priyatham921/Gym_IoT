<!DOCTYPE html>
<html>
  <head>
    <title>Stream accelerometer data</title>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.1/mqttws31.js"
      type="text/javascript"
    ></script>
    <script type="text/javascript" language="javascript">
      var mqtt;
      var reconnectTimeout = 2000;
      var host = "192.168.0.105";
      var port = 9001;

      function onConnect() {
        console.log("Connected");
        document.getElementById("status").innerHTML = "Connected to Broker";
        message = new Paho.MQTT.Message("Hello World");
        message.destinationName = "sensornode/livestream";
        mqtt.send(message);
      }

      function onFailure() {
        console.log("connection failed");
        document.getElementById("status").innerHTML = "connection failed";
        setTimeout(MQTTconnect, reconnectTimeout);
      }

      function MQTTconnect() {
        console.log("connecting to broker");
        document.getElementById("status").innerHTML = "connecting to broker";
        mqtt = new Paho.MQTT.Client(host, port, "clientjs");
        var options = {
          timeout: 5,
          onSuccess: onConnect,
          onFailure: onFailure,
        };
        mqtt.connect(options);
      }
    </script>
    <!-- <script src="main.js"></script> -->
  </head>
  <body>
    <div id="mqtt">accelerometer data</div>
    <div id="status"></div>
    <div id="acc_data_x"></div>
    <div id="acc_data_y"></div>
    <div id="acc_data_z"></div>
    <script>
      MQTTconnect();
    </script>
  </body>
</html>
